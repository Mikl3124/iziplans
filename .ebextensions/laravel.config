option_settings:
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: document_root
    value: /public
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: memory_limit
    value: 512M
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: upload_max_filesize
    value: 9M
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: post_max_size
    value: 9M

container_commands:
  11-install-npm-dependencies:
    command: sudo npm ci
  12-run-npm:
    command: sudo npm run prod
  13-artisan-migrate:
    command: php artisan migrate --force
  14-caches:
    command: |
      php artisan config:cache
      php artisan route:cache
      php artisan view:cache
  15-fix_permissions:
    command: "chmod 777 -R /var/app/current"
